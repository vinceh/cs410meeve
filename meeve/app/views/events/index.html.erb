<title></title>

<h1>Events</h1>
<%= link_to 'Create an Event', :action => :new %><br>
<%= flash[:msg] unless flash[:msg] == nil%>
<% @events.each do |event| %>

	<h3><%= event.title %></h3>
	<%= event.desc %><br>
	Where: <%= event.location %><br/>
	From: <%= event.start_date %><br/>
	Until: <%= event.end_date %><br/>
	
	<%= link_to 'Edit', :action => :edit, :eid => event.event_id %>
	<%= link_to 'Remove', :action => :remove, :eid => event.event_id %><br>
	
	<%= content_tag :div, :id => "comment_block_" + event.event_id.to_s do %>
		<% event.comments.each do |c| %>
			<%= content_tag :div, :id => "comment" + c.cid.to_s do %>
				<b><%= c.commenter %></b>
				<%= c.body %>
				<%= link_to 'x', {:controller => :comments, :action => :remove, :cid => c.cid }, :remote => true %><br/>
			<% end %>
		<% end %>
	<% end %>
	
	<%= form_for([event, event.comments.build], :remote => true ) do |f| %>
		    <%= f.hidden_field :commenter, :value => "Guest" %>
		    <%= f.text_field :body, :class => "commentBox" %>
		 	<%= f.hidden_field :timestamp, :value => Time.now %>
		  	<br/>
		    <%= f.submit "Comment", :class => "submit" %>
	<% end %>	
<% end %>